中国矿业大学云课堂平台专用爬虫，用于下载云课堂上的课程视频。

至于为什么开发这个爬虫，因为我不喜欢云课堂的在线播放体验。

# 能做的事

1. 能下载云课堂上面的视频。
2. 稍微读一下ykt.py的代码可以实现只下载除了某一段时期以外的剩下所有视频（比如说疫情时期）。
3. 实现了矿大的统一认证登录，改一下代码可以用于其他功能的爬虫。（yktLogin函数的前一部分）

# 使用说明

1. 在使用前先确保你的python已经安装Crypto库，否则请把references.txt文件中的内容放入cmd下运行。
2. 然后在passwd.py文件中写入云课堂的账号以及密码。
3. 再在main.py中修改你需下载的课程名称以及保存位置。
4. 最后运行main.py即可。

# 技术细节

**主要步骤**：1）模拟浏览器访问登录页，2）提交统一身份认证，3）再通过云课堂的网络函数来获取所需要的信息，4）最后把视频下载下来。

**几个要点：**

1. 在把统一身份认证的账户密码交给服务器前，要先对用户密码进行AES CBC加密。padding方式采用pkcs7，加密密钥在登录页html中，由 id为“pwdEncryptSalt”的input框的value字段给出。

2. 登录成功后会重定向两次，其中第二次跳转的url中有ticket参数，要保存下来，用来后面求userId，所以不能让python的requests库帮我们自动重定向，得手动跳转。userId是获取所有课程的信息时必要的信息。

3. 云课堂应用里像你的课程列表、视频连接这样的信息都是通过向某个链接发送GET请求得到的，并不能在运行js脚本之前的html页中找到。
4. 每一次请求信息的url后面都要跟一个"validCode"参数，这个参数的值是啥能在js里找到，如果是获取单个视频的详细信息，这个值取md5(“id=”+videoDetailId+"&signKey=123123")（md5结果，用16进制表示）；如果是获取用户的个人信息，这个值取md5(“id=”+userId+"&signKey=123123")；如果是请求其他的普通信息，这个值取md5("&signKey=123123") ；

